/*! imsep 2021-01-09 */

var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,a,i,r,n,o,s,d="",l=0;if(!e)return e;for(e=Base64._utf8_encode(e);l<e.length;)r=(t=e.charCodeAt(l++))>>2,n=(3&t)<<4|(a=e.charCodeAt(l++))>>4,o=(15&a)<<2|(i=e.charCodeAt(l++))>>6,s=63&i,isNaN(a)?o=s=64:isNaN(i)&&(s=64),d=d+this._keyStr.charAt(r)+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return d},decode:function(e){var t,a,i,r,n,o,s="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)t=this._keyStr.indexOf(e.charAt(d++))<<2|(r=this._keyStr.indexOf(e.charAt(d++)))>>4,a=(15&r)<<4|(n=this._keyStr.indexOf(e.charAt(d++)))>>2,i=(3&n)<<6|(o=this._keyStr.indexOf(e.charAt(d++))),s+=String.fromCharCode(t),64!=n&&(s+=String.fromCharCode(a)),64!=o&&(s+=String.fromCharCode(i));return s=Base64._utf8_decode(s)},_utf8_encode:function(e){if(!e)return e;e=e.replace(/\r\n/g,"\n");for(var t="",a=0;a<e.length;a++){var i=e.charCodeAt(a);i<128?t+=String.fromCharCode(i):(127<i&&i<2048?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){for(var t="",a=0,i=c1=c2=0;a<e.length;)(i=e.charCodeAt(a))<128?(t+=String.fromCharCode(i),a++):191<i&&i<224?(c2=e.charCodeAt(a+1),t+=String.fromCharCode((31&i)<<6|63&c2),a+=2):(c2=e.charCodeAt(a+1),c3=e.charCodeAt(a+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),a+=3);return t}};$(function(){$.fn.select2.defaults.set("theme","bootstrap"),app.name="iMSEP",$(".convertTolocalDateTime").each(function(e){var t=$(this).text(),a=new Date(t),i=a.toString();i=a.toLocaleString();var r=$(this).attr("title");r||(r=""),r=r+" ("+a.toLocaleString("en",{timeZone:"UTC"})+" GMT)",$(this).attr("title",r),$(this).text(i)}),$('div[data-notify="true"]').each(function(e){$.notify({message:$(this).html()},{type:$(this).data("notify-type")||"info",delay:$(this).data("notify-delay"),animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})})}),function(o){var s,d=o();o.fn.sortable=function(n){var e=String(n);return n=o.extend({connectWith:!1},n),this.each(function(){if(/^(enable|disable|destroy)$/.test(e)){var t=o(this).children(o(this).data("items")).attr("draggable","enable"==e);"destroy"==e&&t.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s")}else{t=o(this).children(n.items);var a,i,r=o("<"+(/^(ul|ol)$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">');t.find(n.handle).mousedown(function(){a=!0}).mouseup(function(){a=!1}),o(this).data("items",n.items),d=d.add(r),n.connectWith&&o(n.connectWith).add(this).data("connectWith",n.connectWith),t.attr("draggable","true").on("dragstart.h5s",function(e){if(n.handle&&!a)return!1;a=!1;var t=e.originalEvent.dataTransfer;t.effectAllowed="move",t.setData("Text","dummy"),i=(s=o(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",function(){s&&(s.removeClass("sortable-dragging").show(),d.detach(),i!=s.index()&&s.parent().trigger("sortupdate",{item:s}),s=null)}).not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end().add([this,r]).on("dragover.h5s dragenter.h5s drop.h5s",function(e){return!t.is(s)&&n.connectWith!==o(s).parent().data("connectWith")||("drop"==e.type?(e.stopPropagation(),d.filter(":visible").after(s),s.trigger("dragend.h5s")):(e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",t.is(this)?(n.forcePlaceholderSize&&r.height(s.outerHeight()),s.hide(),o(this)[r.index()<o(this).index()?"after":"before"](r),d.not(r).detach()):d.is(this)||o(this).children(n.items).length||(d.detach(),o(this).append(r))),!1)})}})}}(jQuery),function(d){function n(e){return/[.]/.exec(e)?/[^.]+$/.exec(e)[0].toLowerCase():null}d.validator.addMethod("url2",function(e,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},d.validator.messages.url),d.validator.unobtrusive.adapters.add("url2",[],function(e){e.rules.url2=e.params,e.message&&(e.messages.url2=e.message)}),d.validator.addMethod("positivenumber",function(e,t,a){return 0<Number(e)},""),d.validator.unobtrusive.adapters.add("positivenumber",[],function(e){e.rules.positivenumber=e.params,e.message&&(e.messages.positivenumber=e.message)}),d.validator.addMethod("integer",function(e,t){return this.optional(t)||/^-?\d+$/.test(e)},"A positive or negative non-decimal number please"),d.validator.unobtrusive.adapters.add("integer",[],function(e){e.rules.integer=e.params,e.message&&(e.messages.integer=e.message)}),d.validator.addMethod("lessthanorequal",function(e,t,a){if(""===e)return!0;try{e=parseFloat(e)}catch(e){}var i=a.other,r=e,n=d(t).closest("form").find("[name="+i+"]");try{r=parseFloat(n.val())}catch(e){}return e<=r},""),d.validator.unobtrusive.adapters.add("lessthanorequal",["other"],function(e){e.rules.lessthanorequal=e.params,e.message&&(e.messages.lessthanorequal=e.message)}),d.validator.addMethod("dateafterorequal",function(e,t,a){if(""===e)return!0;try{e+=""}catch(e){}var i=a.other,r=e,n=d(t).closest("form").find("[name="+i+"]");try{r=n.val()+""}catch(e){}return r<=e},""),d.validator.unobtrusive.adapters.add("dateafterorequal",["other"],function(e){e.rules.dateafterorequal=e.params,e.message&&(e.messages.dateafterorequal=e.message)}),d.validator.addMethod("filesize",function(e,t,a){var i=a.maxsize;try{i=parseFloat(i)}catch(e){}var r=d(t),n=r.closest("form").find(":file[name="+r.attr("name")+"]"),o=0;return n.each(function(){var e=d(this)[0].files[0];e&&e.size&&(o+=e.size)}),o<i},""),d.validator.unobtrusive.adapters.add("filesize",["maxsize"],function(e){e.rules.filesize=e.params,e.message&&(e.messages.filesize=e.message)}),d.validator.unobtrusive.adapters.add("filetype",["validtypes"],function(e){e.rules.filetype={validtypes:e.params.validtypes.split(",")},e.messages.filetype=e.message}),d.validator.addMethod("filetype",function(e,t,a){for(var i=0;i<t.files.length;i++){var r=n(t.files[0].name);if(-1===d.inArray(r,a.validtypes))return!1}return!0}),d.validator.addMethod("requiredif",function(e,t,a){var i="#"+a.dependentproperty,r=a.targetvalue;r=(null==r?"":r).toString();var n=d(i),o=n.attr("type"),s=n.val();return s||(s="checkbox"===o||"radio"===o?n.attr("checked"):n.val()),d.trim(r)!==d.trim(s)&&("*"!==d.trim(r)||""===d.trim(s))||d.validator.methods.required.call(this,e,t,a)}),d.validator.unobtrusive.adapters.add("requiredif",["dependentproperty","targetvalue"],function(e){e.rules.requiredif={dependentproperty:e.params.dependentproperty,targetvalue:e.params.targetvalue},e.messages.requiredif=e.message})}(jQuery);var waitingDialog=waitingDialog||function(i){"use strict";var r=i('<div class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true" style="padding-top:15%; overflow-y:visible;"><div class="modal-dialog modal-m"><div class="modal-content"><div class="modal-header"><h3 style="margin:0;"></h3></div><div class="modal-body"><div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div></div></div></div></div>');return{show:function(e,t){void 0===t&&(t={}),void 0===e&&(e="Loading");var a=i.extend({dialogSize:"m",progressType:"",onHide:null},t);r.find(".modal-dialog").attr("class","modal-dialog").addClass("modal-"+a.dialogSize),r.find(".progress-bar").attr("class","progress-bar"),a.progressType&&r.find(".progress-bar").addClass("progress-bar-"+a.progressType),r.find("h3").html(e),"function"==typeof a.onHide&&r.off("hidden.bs.modal").on("hidden.bs.modal",function(e){a.onHide.call(r)}),r.modal()},hide:function(){r.modal("hide")}}}(jQuery),waitingDialog2=waitingDialog2||function(i){"use strict";var r=i('<div class="modal fade" id="pleaseWaitDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog modal-m"><div class="modal-content">    <div class="modal-header">        <h1>Processing...</h1>    </div>    <div class="modal-body">      <div class="progress">        <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 100%">          <span class="sr-only"></span>        </div>      </div>    </div>  </div></div></div>');return{show:function(e,t){void 0===t&&(t={}),void 0===e&&(e="Loading");var a=i.extend({dialogSize:"m",progressType:"",onHide:null},t);r.find(".modal-dialog").attr("class","modal-dialog").addClass("modal-"+a.dialogSize),r.find(".progress-bar").attr("class","progress-bar"),a.progressType&&r.find(".progress-bar").addClass("progress-bar-"+a.progressType),r.find("h1").text(e),"function"==typeof a.onHide&&r.off("hidden.bs.modal").on("hidden.bs.modal",function(e){a.onHide.call(r)}),r.modal()},hide:function(){r.modal("hide")},setProgressType:function(e){r.find(".progress-bar").attr("class","progress-bar"),e&&r.find(".progress-bar").addClass("progress-bar-"+e)},setMessage:function(e){r.find("h1").text(e)}}}(jQuery);function ConfirmDialog(){var e=$('<div class="modal fade" style="z-index:1055" id="confirmDialog" role="dialog"><div class="modal-dialog "> <div class="modal-content">\t<div class="modal-header">\t  <button type="button" class="close" data-dismiss="modal">&times;</button>\t  <h4 class="modal-title">Confirm</h4>\t</div>\t<div class="modal-body">\t  <p id="confirmDialog_content">Please Confirm</p>\t</div>\t<div class="modal-footer">\t  <button id="confirmDialog_yes" type="button" class="btn btn-default" data-dismiss="modal">Yes</button>\t  <button  id="confirmDialog_no" type="button" class="btn btn-default" data-dismiss="modal">No</button>\t</div></div></div></div>');this.dialog=e}ConfirmDialog.prototype.show=function(e,t,a){var i=this;i._confirm=!1;var r=this.dialog;void 0===a&&(a={}),void 0===e&&(e="Please Confirm");var n=$.extend({title:"fa"===app.language?"تایید کنید":"Confirm",yesTitle:"fa"===app.language?"بله":"Yes",noTitle:"fa"===app.language?"خیر":"No",dialogSize:"m",alertType:"warning"},a);r.find(".modal-dialog").attr("class","modal-dialog").addClass("modal-"+n.dialogSize),n.alertType&&r.find(".modal-body").addClass("alert-"+n.alertType),r.find(".modal-title").text(n.title),r.find("#confirmDialog_yes").text(n.yesTitle),r.find("#confirmDialog_no").text(n.noTitle),r.find("#confirmDialog_yes").click(function(){i._confirm=!0,r.modal("hide"),window.history.back()}),r.find("#confirmDialog_no").click(function(){i._confirm=!1,r.modal("hide"),window.history.back()}),r.find("#confirmDialog_content").html(e),r.on("hidden.bs.modal",function(){t&&t(i._confirm);n.title;history.pushState("",document.title,window.location.pathname+window.location.search)});var o=n.title;window.location.hash=o,window.onhashchange=function(){location.hash||r.modal("hide")},r.modal()},ConfirmDialog.prototype.hide=function(){this.dialog.modal("hide")},ConfirmDialog.prototype.setMessage=function(e){this.dialog.find("#confirmDialog_content").html(e)};var confirmDialog=new ConfirmDialog,app={name:"untitled",layout:"ltr",language:"en",version:"1.0.0",identity:void 0,pageData:{},eventHandlers:[],snapInteractions:[],initMap_Lon:37.41,initMap_Lat:9,initMap_Zoom:4,DROPDOWN_NULL:"[Not filled]",OSM_REQUEST_TIMEOUT:2e4,OSM_FEATURE_COUNT_LIMIT1:1e5,OSM_FEATURE_COUNT_LIMIT2:5e5,MAx_TABLE_VIEW_RECORDS:1e3,get_uploadattachments_url:function(){return"/dataset/uploadattachments"},get_attachment_url:function(e,t,a){return a?"/dataset/"+e+"/attachment/"+t+"?thumbnail=true":"/dataset/"+e+"/attachment/"+t},routeServiceTokens:[],overpassApiServer:"//overpass-api.de/api/interpreter",setIdentity:function(e){this.identity=JSON.parse(e)},set_UPLOAD_RASTER_MAX_SIZE_MB:function(e){this.UPLOAD_RASTER_MAX_SIZE_MB=e},set_UPLOAD_SHAPEFILE_MAX_SIZE_MB:function(e){this.UPLOAD_SHAPEFILE_MAX_SIZE_MB=e},set_UPLOAD_FILE_MAX_SIZE_MB:function(e){this.UPLOAD_FILE_MAX_SIZE_MB=e},set_ROUTE_SERVICE_TOKENS:function(e){e&&(this.routeServiceTokens=e.split(","))},render:function(e,t){return t||(t=this),"undefined"==typeof vash?"vash engine is not loaded":vash.compile(e)(t)},sanitizeHtml:function(e,t){return DOMPurify.sanitize(e,t)},sanitizeHtml_JQuery:function(e,t){return(t=t||{}).SAFE_FOR_JQUERY=!0,DOMPurify.sanitize(e,t)},htmlEncode:function(e){if(!e)return e;for(var t=[],a=e.length-1;0<=a;a--)t.unshift(["&#",e[a].charCodeAt(),";"].join(""));return t.join("")},htmlDecode:function(e){return(e+="").replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})},test:function(e){alert(e)},isMobile:function(){var e=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(e=!0),e},registerEventhandler:function(e,t){var a=this.eventHandlers[e];a||(a=[],this.eventHandlers[e]=a),a.push(t)},unRegisterEventhandler:function(e,t){var a=this.eventHandlers[e];a||(a=[],this.eventHandlers[e]=a);var i=a.findIndex(function(e){return!(!t||t!=e)});-1<i&&a.splice(i,1)},dispatchEvent:function(e,t){var a=this.eventHandlers[e];a||(a=[],this.eventHandlers[e]=a);for(var i=a.length,r=0;r<i&&(!a[r]||!(!1===a[r].call(this,t)||t&&t.propagationStopped));r++);},registerSnapInteraction:function(e){this.snapInteractions.push(e)},addSnapInteractions:function(e){if(e)for(var t=0;t<this.snapInteractions.length;t++)e.removeInteraction(this.snapInteractions[t]),this.snapInteractions[t].getActive()&&e.addInteraction(this.snapInteractions[t])},removeSnapInteractions:function(e){if(e)for(var t=0;t<this.snapInteractions.length;t++)e.removeInteraction(this.snapInteractions[t])},url_needs_proxy:function(e){var t=!1;if(!e)return t;if(0==(e=(e+"").toLowerCase()).indexOf("/"))return t;var a=window.location.href.split("/"),i=a[0]+"//"+a[2];return i=i.toLowerCase(),t=0!=e.indexOf(i)},get_proxy_url:function(e){return"/proxy/?url="+encodeURIComponent(e)}};